\documentclass{article}
\usepackage{jheppub,physics,amsfonts,graphicx,tensor,cleveref}
\usepackage[export]{adjustbox}
% TikZ for contour figures
\usepackage{tikz}
\usetikzlibrary{arrows.meta,decorations.pathreplacing,positioning,decorations.markings}
\newcommand{\ii}{\mathrm{i}}
\newcommand{\me}{\mathrm{e}}
\newcommand{\cd}{\mathcal{D}}
\DeclareMathOperator{\arcsinh}{arcsinh}
\DeclareMathOperator{\sgn}{sgn}
\counterwithout{equation}{section}


\title{Homework 3}
\author{Shangjie Zhou}
\emailAdd{zhou1468@purdue.edu}
\toccontinuoustrue
\notoc


\begin{document}

\maketitle


\section*{Problem 1}
\subsection*{(a)}
For the case of Bosons, we know that the poles of $u_+(z)=\tfrac{1}{2}\coth(\beta z/2)$ are at $z=\ii 2\pi n/\beta$ for $n\in \mathbb{Z}$. Using $\operatorname*{Res}_{w=\ii\pi n}\coth w=1$ and the change of variables $w=\beta z/2$, we have $\operatorname*{Res}_{z=\ii 2\pi n/\beta}\coth(\beta z/2)=2/\beta$, hence
\begin{equation}
    \operatorname*{Res}\big(u_+(z), z=\ii 2\pi n/\beta\big) = \frac{1}{2}\cdot\frac{2}{\beta} = \frac{1}{\beta}.
\end{equation}
Therefore,
\begin{equation}
    S=\frac{1}{2\pi\ii}\oint_\mathcal{C}\dd{z}\; f(z)\,u_+(z)=\sum_{n=-\infty}^{\infty} f\!\left(\frac{\ii 2\pi n}{\beta}\right)\cdot \frac{1}{\beta} = \frac{1}{\beta}\sum_{n=-\infty}^{\infty} f\!\left(\frac{\ii 2\pi n}{\beta}\right)=\frac{1}{\beta}\sum_n f(\ii\omega_n).
\end{equation}
The case of Fermions can be shown similarly.

\subsection*{(b)}
After deforming the contour to $\mathcal{C}'$ as shown in the figure, we have
\begin{equation}
    S=-\sum_{z_j\in\text{poles of }f}\operatorname*{Res}\big(f(z)u_+(z), z=z_j\big)
\end{equation}
% Matsubara contour figure inserted for Problem 1(b)
\begin{center}
\begin{tikzpicture}[scale=0.95]
    % axes
    \draw[->] (-5.2,0) -- (5.2,0) node[right] {Re\,z};
    \draw[->] (0,-4.5) -- (0,4.5) node[above] {Im\,z};

    % imaginary axis Matsubara points (fermionic/bosonic positions - label generically i\omega_n)
    \foreach \n/\y in {-3/-3.5,-2/-2.5,-1/-1.5,1/1.5,2/2.5,3/3.5}
    {
        \fill[blue] (0,\y) circle(1.8pt);
    }
    \node[left] at (0,1.5) {$i\omega_{1}$};
    \node[left] at (0,2.5) {$i\omega_{2}$};
    % vertical ellipsis between omega_2 and omega_n
    \node[left] at (0,3.0) {$\vdots$};
    \node[left] at (0,3.5) {$i\omega_{n}$};
    \node[left] at (0,-1.5) {$i\omega_{-1}$};
    \node[left] at (0,-2.5) {$i\omega_{-2}$};
    % vertical ellipsis on negative side
    \node[left] at (0,-3.0) {$\vdots$};
    \node[left] at (0,-3.5) {$i\omega_{-n}$};

    % example real-axis poles
    \draw[fill=red] (1.6,0) circle(2pt) node[below right] {\small $\epsilon_1$};
    \draw[fill=red] (-2.2,0) circle(2pt) node[below left] {\small $\epsilon_2$};

    % contour C' (deformed) - rectangular with small detours around real poles
    % draw each side as a separate segment and place a single arrow at the midpoint
    \draw[thick,postaction={decorate},decoration={markings,mark=at position 0.5 with {\arrow{Latex}}}] (-1,4) -- (1,4);
    \draw[thick,postaction={decorate},decoration={markings,mark=at position 0.5 with {\arrow{Latex}}}] (1,4) -- (1,-4);
    \draw[thick,postaction={decorate},decoration={markings,mark=at position 0.5 with {\arrow{Latex}}}] (1,-4) -- (-1,-4);
    \draw[thick,postaction={decorate},decoration={markings,mark=at position 0.5 with {\arrow{Latex}}}] (-1,-4) -- (-1,4);

    % semicircles whose diameters are the vertical sides (centered at x=1 and x=-1, radius=4)
    % right semicircle (to the right of the rectangle)
    \draw[dashed,postaction={decorate},decoration={markings,
        mark=at position 0.33 with {\arrow{Latex}},
        mark=at position 0.66 with {\arrow{Latex}}}]
        (1,-4) arc[start angle=-90,end angle=90,radius=4];
    % left semicircle was here; reflected across vertical axis to the right side
    % mirrored semicircle (to the right, bottom->top) so together with the other arc they form a full circle at x=1
    \draw[dashed,postaction={decorate},decoration={markings,
        mark=at position 0.33 with {\arrow{Latex}},
        mark=at position 0.66 with {\arrow{Latex}}}]
        (-1,4) arc[start angle=90,end angle=270,radius=4];



\end{tikzpicture}
\end{center}


\subsection*{(c)}
When we choose
\begin{equation}
    f(z)=\frac{1}{(z-\epsilon_1)(z-\epsilon_2)}
\end{equation}
we have two poles at $z=\epsilon_1$ and $z=\epsilon_2$. Therefore,
\begin{equation}
    \begin{split}
        S & =-\operatorname*{Res}\big(f(z)u_+(z), z=\epsilon_1\big)-\operatorname*{Res}\big(f(z)u_+(z), z=\epsilon_2\big) \\
          & =-\frac{u_{+}(\epsilon_1)}{\epsilon_1-\epsilon_2}-\frac{u_{+}(\epsilon_2)}{\epsilon_2-\epsilon_1}             \\
          & =\frac{-u_{+}(\epsilon_1)+u_{+}(\epsilon_2)}{\epsilon_1-\epsilon_2}
    \end{split}
\end{equation}
Since the particle number distribution function for Bosons is $n_B(\epsilon) = \frac{1}{\me^{\beta\epsilon}-1} = u_+(\epsilon)-\frac{1}{2}$, we have
\begin{equation}
    S=-\frac{n_B(\epsilon_1)-n_B(\epsilon_2)}{\epsilon_1-\epsilon_2}.
\end{equation}


\section*{Problem 2}
\subsection*{(a)}
The Euclidean action for the harmonic oscillator is
\begin{equation}
    S_E[x] = \int_0^{\beta} \dd{\tau} \left[ \frac{m}{2} \left( \frac{\dd{x}}{\dd{\tau}} \right)^2 + \frac{m\omega^2}{2} x^2 \right].
\end{equation}
and the overlap $\bra{x(\beta)=x_f}\ket{x(0)=x_i}$ is given by
\begin{equation}
    \bra{x(\beta)=x_f}\ket{x(0)=x_i}=\bra{x_f}\me^{-\beta H}\ket{x_i} = \int_{x(0)=x_i}^{x(\beta)=x_f} \mathcal{D}x \; e^{-S_E[x]}.
\end{equation}
The partition function is given by
\begin{equation}
    Z = \int \dd{x} \; \bra{x}\me^{-\beta H}\ket{x} = \int \dd{x} \; \int_{x(0)=x}^{x(\beta)=x} \mathcal{D}x \; e^{-S_E[x]}.
\end{equation}

\subsection*{(b)}
Consider the following Euclidean action with an external source $j(\tau)$:
\begin{equation}
    S_E[x,j] = \int_0^{\beta} \dd{\tau} \left[ \frac{m}{2} \left( \frac{\dd{x}}{\dd{\tau}} \right)^2 + \frac{m\omega^2}{2} x^2 - jx \right].
\end{equation}
The correlation function can be written as
\begin{equation}
    G(\tau)=\expval{T_\tau x(\tau)x(0)}=\frac{1}{Z}\int \mathcal{D}x \; x(\tau)x(0) \; e^{-S_E[x]}=\frac{1}{Z}\frac{\delta^2 Z[j]}{\delta j(\tau)\delta j(0)}\Bigg|_{j=0},
\end{equation}
where
\begin{equation}
    Z[j] =\int\dd{x} \int_{x(0)=x}^{x(\beta)=x} \mathcal{D}x \; e^{-S_E[x,j]}.
\end{equation}

\subsection*{(c)}
To compute the generating functional $Z[j]$, we can use the following Gaussian functional integral formula:
\begin{equation}
    \int \mathcal{D}\phi \; \exp\left[-\frac{1}{2}\int \dd{x} \dd{y} \; \phi(x)A(x,y)\phi(y) + \int \dd{x} \; J(x)\phi(x)\right] \sim (\det A)^{-\frac{1}{2}} \exp\left[\frac{1}{2}\int \dd{x} \dd{y} \; J(x)A^{-1}(x,y)J(y)\right].
\end{equation}
After integrating by parts, the Euclidean action can be rewritten as
\begin{equation}
    S_E[x,j] = \int_0^{\beta} \dd{\tau} \left[ \frac{m}{2} x \left( -\frac{\dd^2}{\dd{\tau}^2} + \omega^2 \right) x - jx \right]
\end{equation}
Therefore, we identify $A(\tau,\tau') = m\left( -\frac{\dd^2}{\dd{\tau}^2} + \omega^2 \right)\delta(\tau-\tau')$ and $J(\tau) = j(\tau)$.
The generating functional is then given by
\begin{equation}
    Z[j] \sim (\det A)^{-\frac{1}{2}} \exp\left[\frac{1}{2}\int_0^{\beta} \dd{\tau} \dd{\tau'} \; j(\tau) A^{-1}(\tau,\tau') j(\tau')\right],
\end{equation}
and the partition function is
\begin{equation}
    Z = Z[0] \sim (\det A)^{-\frac{1}{2}}.
\end{equation}
The normalization factor $(\det A)^{-\frac{1}{2}}$ can be canceled when evaluating the correlation function, so we can focus on the exponent part.
The inverse operator $A^{-1}(\tau,\tau')$ satisfies
\begin{equation}
    m\left( -\frac{\dd^2}{\dd{\tau}^2} + \omega^2 \right) A^{-1}(\tau,\tau') = \delta(\tau-\tau')\label{eq:Ainverse}
\end{equation}
and we can solve for $A^{-1}(\tau,\tau')$ by expanding it in Fourier series:
\begin{equation}
    A^{-1}(\tau,\tau') = \frac{1}{\beta} \sum_{n=-\infty}^{\infty} \tilde{A}^{-1}(\omega_n) \me^{-\ii \omega_n (\tau-\tau')}.\label{eq:Ainverse_fourier}
\end{equation}
where $\omega_n = 2\pi n/\beta$ are the Bosonic Matsubara frequencies.
After plugging \cref{eq:Ainverse_fourier} into \cref{eq:Ainverse}, we have
\begin{equation}
    m(\omega_n^2 + \omega^2) \tilde{A}^{-1}(\omega_n) = 1 \implies \tilde{A}^{-1}(\omega_n) = \frac{1}{m(\omega_n^2 + \omega^2)},
\end{equation}
so
\begin{equation}
    A^{-1}(\tau,\tau') = \frac{1}{\beta m} \sum_{n=-\infty}^{\infty} \frac{\me^{-\ii \omega_n (\tau-\tau')}}{\omega_n^2 + \omega^2}.
\end{equation}
Now we are ready to compute the correlation function:
\begin{equation}
    \begin{split}
        G(\tau) & =\frac{1}{Z}\frac{\delta^2 Z[j]}{\delta j(\tau)\delta j(0)}\Bigg|_{j=0} = \frac{\delta^2}{\delta j(\tau)\delta j(0)} \exp\left[\frac{1}{2}\int_0^{\beta} \dd{\tau_1} \dd{\tau_2} \; j(\tau_1) A^{-1}(\tau_1,\tau_2) j(\tau_2)\right]\Bigg|_{j=0} \\
                & =A^{-1}(\tau,0) = \frac{1}{\beta m} \sum_{n=-\infty}^{\infty} \frac{\me^{-\ii \omega_n \tau}}{\omega_n^2 + \omega^2}.
    \end{split}
\end{equation}
Using the Matsubara sum formula derived in Problem 1, we choose 
\begin{equation}
    f(z) = \frac{\me^{-\tau z}}{z^2 - \omega^2}
\end{equation}
and find that
\begin{equation}
    \begin{split}
        G(\tau) &= \frac{1}{m}\sum_{z_i\in\text{poles of }f} \operatorname*{Res}\big(f(z)u_+(z), z=z_i\big)\\
                &= \frac{1}{m}(\operatorname*{Res}\big(f(z)u_+(z), z=\omega\big) + \operatorname*{Res}\big(f(z)u_+(z), z=-\omega\big))\\
                &= \frac{1}{m}\left(\frac{\me^{-\tau \omega}}{2\omega}u_+(\omega) - \frac{\me^{\tau \omega}}{2\omega}u_+(-\omega)\right)\\
    \end{split}
\end{equation}
Using that $u_+(z)=\coth(\beta z/2)/2$, we have 
\begin{equation}
    G(\tau) = \frac{\me^{-\tau\omega}\coth(\beta\omega/2)-\me^{\tau\omega}\coth(-\beta\omega/2)}{4m\omega}=\frac{(\me^{-\tau\omega}+\me^{\tau\omega})\coth(\beta\omega/2)}{4m\omega}.
\end{equation}


\section*{Problem 3}
\subsection*{(a)}
Since $A$ is a real symmetric matrix, it can be diagonalized by an orthogonal matrix $O$ such that $A=O^T \Lambda O$, where $\Lambda$ is a diagonal matrix with eigenvalues $\lambda_i$ on the diagonal. 
The Gaussian integral can be computed as follows:
\begin{equation}
    \begin{split}
        Z(J) & = \int \dd^n x \; \exp\left(-\frac{1}{2} x^T A x+J^T x\right)\\
             & = \int \dd[n]{x} \exp(-\frac{1}{2}x^T O^T \Lambda Ox+J^T x)\\
             & = \int \dd[n]{x} \exp(-\frac{1}{2}x^T O^T \Lambda Ox+J^T O^T O x)\\
             & = \int \dd[n]{y} \exp(-\frac{1}{2}y^T \Lambda y +(OJ)^T y)\\
             & = \prod_{i=1}^n \int \dd{y_i} \exp\left(-\frac{1}{2}\lambda_i y_i^2 + (OJ)_i y_i\right)\\
             & = \prod_{i=1}^n \int \dd{y_i} \exp(-\frac{1}{2}\lambda_i y_i^2 +(OJ)_i y_i -\frac{(OJ)_i^2}{2\lambda_i} + \frac{(OJ)_i^2}{2\lambda_i})\\
             & = \prod_{i=1}^n \int \dd{y_i} \exp[-\frac{1}{2}\lambda_i \left(y_i - \frac{(OJ)_i}{\lambda_i}\right)^2 + \frac{(OJ)_i^2}{2\lambda_i}]\\
             & = \prod_{i=1}^n \sqrt{\frac{2\pi}{\lambda_i}} \exp[\frac{(OJ)_i^2}{2\lambda_i}]\\
             & = \sqrt{\frac{(2\pi)^n}{\det A}} \exp(\frac{1}{2} J^T A^{-1} J).
    \end{split}
\end{equation}
\subsection*{(b)}
We can verify that 
\begin{equation}
    \pdv{J_i}\ln{Z(J)}=\frac{1}{Z(J)}\pdv{Z(J)}{J_i}=\frac{1}{Z(J)}\int \dd^n x \; x_i \exp\left(-\frac{1}{2} x^T A x+J^T x\right)=\expval{x_i}_J
\end{equation}
and by using the result from part (a),
\begin{equation}
    \expval{x_i}_J = \pdv{J_i}\ln{Z(J)} = \pdv{J_i} \left( \frac{1}{2} J^T A^{-1} J \right) = \sum_{j=1}^n A^{-1}_{ij} J_j=(A^{-1}J)_i.
\end{equation}

For the two-point correlation function, we have
\begin{equation}
    \begin{split}
        \expval{x_i x_j}_J &= \frac{1}{Z(J)} \int \dd^n x \; x_i x_j \exp\left(-\frac{1}{2} x^T A x + J^T x\right)\\
                           &=\frac{1}{Z(J)}\frac{\partial^2}{\partial J_i \partial J_j} Z(J)\\
                           &= \frac{\partial^2}{\partial J_i \partial J_j} \left( \frac{1}{2} J^T A^{-1} J \right) + \left( \frac{\partial}{\partial J_i} \left( \frac{1}{2} J^T A^{-1} J \right) \right) \left( \frac{\partial}{\partial J_j} \left( \frac{1}{2} J^T A^{-1} J \right) \right)\\
                           &=( A^{-1})_{ij} + (A^{-1}J)_i (A^{-1}J)_j.
    \end{split}
\end{equation}

\subsection*{(c)}
For the 4-point correlation function, we have
\begin{equation}
    \begin{split}
        \expval{x_i x_j x_k x_l}_J &= \frac{1}{Z(J)} \int \dd^n x \; x_i x_j x_k x_l \exp\left(-\frac{1}{2} x^T A x + J^T x\right)\\ 
                                   &= \frac{1}{Z(J)} \frac{\partial^4}{\partial J_i \partial J_j \partial J_k \partial J_l} Z(J)\\
                                   &= \frac{\partial}{\partial J_i} \left( \frac{1}{2} J^T A^{-1} J  \right)  \frac{\partial}{\partial J_j} \left( \frac{1}{2} J^T A^{-1} J  \right) \frac{\partial}{\partial J_k} \left( \frac{1}{2} J^T A^{-1} J \right)  \frac{\partial}{\partial J_l} \left( \frac{1}{2} J^T A^{-1} J \right)\\
                                   &\quad+\frac{\partial}{\partial J_i} \left( \frac{1}{2} J^T A^{-1} J  \right)\frac{\partial}{\partial J_j} \left( \frac{1}{2} J^T A^{-1} J  \right)\frac{\partial^2}{\partial J_k \partial J_l} \left( \frac{1}{2} J^T A^{-1} J \right)+\dots\\
                                   &\quad + \frac{\partial^2}{\partial J_i \partial J_j} \left( \frac{1}{2} J^T A^{-1} J \right) \frac{\partial^2}{\partial J_k \partial J_l} \left( \frac{1}{2} J^T A^{-1} J \right)+\dots\\
                                   &=\mu_i \mu_j \mu_k \mu_l\\
                                   &\quad+\mu_i\mu_j C_{kl}+\mu_i\mu_k C_{jl}+\dots\\
                                   &\quad + C_{ij} C_{kl} + C_{ik} C_{jl} + C_{il} C_{jk}
    \end{split}
\end{equation}
where we used the fact that all the derivative of order higher than 2 vanish.
When $J=0$, we have $\mu_i=0$ and thus
\begin{equation}
    \expval{x_i x_j x_k x_l}_{J=0} = C_{ij} C_{kl} + C_{ik} C_{jl} + C_{il} C_{jk}.
\end{equation}
For general even $n$, we can consider the following derivative of $Z(J)$:
\begin{equation}
    \expval{x_{i_1} x_{i_2} \dots x_{i_n}}_J = \frac{1}{Z(J)}\frac{\partial^n}{\partial J_{i_1} \partial J_{i_2} \dots \partial J_{i_n}} Z(J).
\end{equation}
and similarly apply Leibniz rule to obtain the sum over all ways of partitioning the indices into paired covariances $C_{ij}$ and singletons replaced by means $\mu_i$.
When $J=0$, we have the usual Wick's theorem:
\begin{equation}
    \expval{x_{i_1} x_{i_2} \dots x_{i_n}}_{J=0} = \sum_{\text{all pairings}} \prod_{\text{pairs }(a,b)} C_{ab}.
\end{equation}

\subsection*{(d)}

\subsection*{(e)}

\section*{Problem 4}
After expanding $\exp(-\Psi^T A\Psi)$, the only term that contribute to the integral is $\frac{1}{N!}(-\Psi^T A \Psi)^N$.
Therefore, we have 
\begin{equation}
    \begin{split}
        \int\mathcal{D}\Psi \; \exp(-\Psi^T A \Psi)&=\int\mathcal{D}\Psi \; \frac{1}{N!}(-\Psi^T A \Psi)^N\\
                                                   &=\int\mathcal{D}\Psi \; \frac{1}{N!}\left(-\sum_{ij}\Psi_i A_{ij} \Psi_j\right)^N
    \end{split}
\end{equation}
Since the Grassmann numbers cannot appear more than once in the integrand, we need to pick out the term that contains all $\Psi_1, \Psi_2, \dots, \Psi_{2N}$ exactly once. This can be done by choosing $N$ pairs of indices $(i_k,j_k)$ such that $\{i_1,j_1,i_2,j_2,\dots,i_N,j_N\}=\{1,2,\dots,2N\}$. 
Therefore, we have
\begin{equation}
    \left(\sum_{ij}\Psi_i A_{ij} \Psi_j\right)^N =N! \sum_{P\in S_{2N}} \text{sgn}(P) \prod_{i=1}^{2N} \Psi_i \prod_{i=1}^N A_{P(2i-1),P(2i)}
\end{equation}
where the $\text{sgn}(P)$ comes from the permutation of the Grassmann numbers.
Thus, we have
\begin{equation}
    \begin{split}
        \int\mathcal{D}\Psi \; \exp(-\Psi^T A \Psi)&=\int\mathcal{D}\Psi \; \frac{1}{N!}(-1)^N N! \sum_{P\in S_{2N}} \text{sgn}(P) \prod_{i=1}^{2N} \Psi_i \prod_{i=1}^N A_{P(2i-1),P(2i)}\\
                                                   &=\sum_{P\in S_{2N}} \text{sgn}(P) \prod_{i=1}^N A_{P(2i-1),P(2i)}\\
                                                   &=\operatorname{Pf}(A)
    \end{split}
\end{equation}
where we used the integral of Grassmann numbers 
\begin{equation}
    \int\dd{\Psi_1}\dd{\Psi_2}\dots\dd{\Psi_{2N}} \; \prod_{i=1}^{2N} \Psi_i = (-1)^N
\end{equation}
and the $(-1)^N$ comes from reordering the Grassmann numbers to $\Psi_{2N}\Psi_{2N-1}\dots\Psi_1$.




%\bibliographystyle{jhep}
%\bibliography{ref}
\end{document}